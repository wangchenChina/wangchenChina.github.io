<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ESP定律手动脱壳</title>
    <link href="/2022/04/12/ESP%E5%AE%9A%E5%BE%8B%E6%89%8B%E5%8A%A8%E8%84%B1%E5%A3%B3/"/>
    <url>/2022/04/12/ESP%E5%AE%9A%E5%BE%8B%E6%89%8B%E5%8A%A8%E8%84%B1%E5%A3%B3/</url>
    
    <content type="html"><![CDATA[<h4 id="手工脱壳常用方法"><a href="#手工脱壳常用方法" class="headerlink" title="手工脱壳常用方法"></a>手工脱壳常用方法</h4><ol><li>单步跟踪法  </li><li>ESP定律法 </li><li>内存镜像法 </li><li>一步到达OEP </li><li>最后一次异常法</li><li>模拟跟踪法</li><li>“SFX”法</li></ol><h4 id="预备知识"><a href="#预备知识" class="headerlink" title="预备知识"></a>预备知识</h4><ul><li><strong>PUSHAD</strong>（入栈&#x2F;压栈）：代表程序的入口点</li><li><strong>POPAD</strong>（弹栈&#x2F;出栈）：代表程序的出口点，与PUSHAD想对应，一般找到这个OEP就在附近</li><li><strong>OEP</strong>（Original Entry Point）：程序的入口点，软件加壳就是隐藏了OEP（或者用了假的OEP&#x2F;FOEP），只要我们找到程序真正的OEP，就可以立刻脱壳</li><li><strong>Dump</strong>：就是转存，在加壳程序中找到入口点，将内存中进程数据保存到硬盘里（普遍用的都是<em>LordPE</em>工具）</li><li><strong>IAT</strong>（Import Address Table ）：就是导入函数的地址表，这段地址存放的就是源程序的API函数地址（通常使用<em>ImportRce</em>修复脱壳时的地址表）</li></ul><h4 id="ESP定律脱壳"><a href="#ESP定律脱壳" class="headerlink" title="ESP定律脱壳"></a>ESP定律脱壳</h4><p><strong>ESP定律的原理</strong>：堆栈平衡原理。</p><p><strong>适用范围</strong>：几乎全部的压缩壳，部分加密壳。</p><p>​               载入程序单步运行(<em>F8</em>)后，只有ESP、EIP寄存器内容发生变化(<em>变红</em>)，那么这个程序大概率可以试用ESP定律。</p><p><strong>具体步骤</strong>：</p><p>Ollydbg打开target.exe，选择不分析代码。</p><p>F8单步执行一步，寄存器窗口只有ESP和EIP的值变红。</p><p>右键ESP，选择“<em>数据窗口中跟踪</em>”。</p><img src="image-20220412102857858.png" alt="image-20220412102857858" style="zoom: 67%;" /><p>在数据窗口，对ESP位置设置硬件断点。右键断点-硬件访问，任意一个类型。</p><img src="image-20220412103258956.png" alt="image-20220412103258956" style="zoom:50%;" /><p>然后F9一键运行程序，会停在popad指令，即恢复源程序环境指令附近。到这里也就说明它的壳环境执行完毕，OEP的位置也就不远了。然后选择调试-硬件断点，删除硬件断点。</p><img src="image-20220412105333517.png" alt="image-20220412105333517" style="zoom: 67%;" /><p>单步执行F8到了<em>jnz</em>位置后，点击它的下一行，然后F4让程序强制转到跳转下面继续运行，F8到达<em>jmp</em>后跳转到程序的OEP领空，确认OEP的位置。</p><img src="image-20220412110708313.png" alt="image-20220412110708313" style="zoom:50%;" /><p>然后，右击程序当前位置第一行代码，选择<em>用OllyDump脱壳调试进程</em>；</p><img src="image-20220412110153981.png" alt="image-20220412110153981" style="zoom:50%;" /><p>最后，我们在弹出的窗口中选择<em>脱壳</em>，然后，输入要另存为的文件名。该文件即为脱壳程序（没有重建IAT）。</p><img src="image-20220412110258393.png" alt="image-20220412110258393" style="zoom:50%;" /><p>如果没有OllyDump插件可以选择使用LordPE进行抓取内存数据。如下：</p><p>Ollydbg运行到OEP位置处，打开LordPE工具，选中脱壳程序target.exe右击<em>纠正镜像大小</em>（防止误读），再次右击选择<em>完全脱壳</em>，转存为dumped.exe。</p><p>然后修复输入表，打开ImportRCE工具，选择带壳程序进程target.exe，刚加载该程序进程的时候，它的OEP并不准确，将程序的实际OEP地址填进去，点击“<em>自动查找IAT</em>”，<em>获取输入表</em>，最后“<em>转储到文件</em>”选择dumped_.exe。</p><p>dumped_.exe即为脱壳程序。</p>]]></content>
    
    
    
    <tags>
      
      <tag>脱壳</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python exe文件的编译与反编译</title>
    <link href="/2022/04/12/Python-exe%E6%96%87%E4%BB%B6%E7%9A%84%E7%BC%96%E8%AF%91%E4%B8%8E%E5%8F%8D%E7%BC%96%E8%AF%91/"/>
    <url>/2022/04/12/Python-exe%E6%96%87%E4%BB%B6%E7%9A%84%E7%BC%96%E8%AF%91%E4%B8%8E%E5%8F%8D%E7%BC%96%E8%AF%91/</url>
    
    <content type="html"><![CDATA[<h3 id="编译Python-代码"><a href="#编译Python-代码" class="headerlink" title="编译Python 代码"></a>编译Python 代码</h3><figure class="highlight cmake"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs cmake">pip <span class="hljs-keyword">install</span> pyinstaller <br></code></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">pyinstaller.<span class="hljs-keyword">exe</span> -F *编译的<span class="hljs-keyword">python</span>文件<span class="hljs-keyword">py</span>*<br></code></pre></td></tr></table></figure><h3 id="反编译Python-EXE"><a href="#反编译Python-EXE" class="headerlink" title="反编译Python EXE"></a>反编译Python EXE</h3><h4 id="下载pyinstxtractor"><a href="#下载pyinstxtractor" class="headerlink" title="下载pyinstxtractor"></a>下载pyinstxtractor</h4><p><a href="https://github.com/extremecoders-re/pyinstxtractor">https://github.com/extremecoders-re/pyinstxtractor</a></p><h4 id="使用pyinstxtractor"><a href="#使用pyinstxtractor" class="headerlink" title="使用pyinstxtractor"></a>使用pyinstxtractor</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> pyinstxtractor.<span class="hljs-keyword">py</span> <span class="hljs-symbol">&lt;filename&gt;</span><br></code></pre></td></tr></table></figure><h4 id="找到相应的pyc文件"><a href="#找到相应的pyc文件" class="headerlink" title="找到相应的pyc文件"></a>找到相应的pyc文件</h4><p>运行后生成xx.exe_extracted文件夹，找到相应的pyc文件（文件夹内的PYZ-00.pyz_extracted文件夹是引入的依赖库）</p><h4 id="反编译pyc文件"><a href="#反编译pyc文件" class="headerlink" title="反编译pyc文件"></a><strong>反编译pyc文件</strong></h4><p>在线反编译 <a href="http://tools.bugscaner.com/decompyle/">http://tools.bugscaner.com/decompyle/</a></p><p>uncompyle6  <a href="https://github.com/rocky/python-uncompyle6/">https://github.com/rocky/python-uncompyle6/</a></p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">pip <span class="hljs-keyword">install</span> uncompyle6<br></code></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">uncompyle6 -o . <span class="hljs-emphasis">*编译的python文件pyc或pyo *</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>驱动人生木马分析</title>
    <link href="/2022/04/11/%E9%A9%B1%E5%8A%A8%E4%BA%BA%E7%94%9F%E6%9C%A8%E9%A9%AC%E5%88%86%E6%9E%90/"/>
    <url>/2022/04/11/%E9%A9%B1%E5%8A%A8%E4%BA%BA%E7%94%9F%E6%9C%A8%E9%A9%AC%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="样本概况"><a href="#样本概况" class="headerlink" title="样本概况"></a>样本概况</h1><figure class="highlight makefile"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">文件: updll.exe</span><br><span class="hljs-section">大小: 201,776 bytes</span><br><span class="hljs-section">文件签名:Shenzhen Smartspace Software technology Co.,Limited</span><br><span class="hljs-section">修改时间: 2020年12月2日, 14:05:51</span><br><span class="hljs-section">MD5: 59B18D6146A2AA066F661599C496090D</span><br><span class="hljs-section">SHA1: 48A3046381A963A2471875EF67886E35B90E8541</span><br><span class="hljs-section">CRC32: 80488116</span><br></code></pre></td></tr></table></figure><h1 id="查壳"><a href="#查壳" class="headerlink" title="查壳"></a>查壳</h1><p>首先使用PEiD和ExeInfo工具对样本进行查壳 以下是查壳结果</p><img src="image-20201207093542398.png" alt="image-20201207093542398" style="zoom: 50%;" /><p><strong>结论：</strong>病毒使用VC6编写的  无壳</p><h1 id="基础分析"><a href="#基础分析" class="headerlink" title="基础分析"></a>基础分析</h1><h2 id="基础静态分析"><a href="#基础静态分析" class="headerlink" title="基础静态分析"></a>基础静态分析</h2><h3 id="查看字符串"><a href="#查看字符串" class="headerlink" title="查看字符串"></a>查看字符串</h3><p>首先在IDA中查看程序的字符串信息 看看能否得出某些信息</p><img src="image-20201207095219894.png" alt="image-20201207095219894" style="zoom:50%;" /><p>在IDA中看到字符串中含有AV检测、系统进程svhost.exe、矿机信息I am tHe xmr reporter等。但具体的还需要再进一步确认。</p><img src="image-20201207095805491.png" alt="image-20201207095805491" style="zoom:50%;" /><p>紧接着看到了http链接，有可能是病毒的通联地址。然后就是大量CMD命令，大概是在执行某些恶意操作 。</p><p>字符串的部分目前提取的信息就这么多，主要还是结合进一步的代码分析。</p><h3 id="使用PEiD识别加密算法"><a href="#使用PEiD识别加密算法" class="headerlink" title="使用PEiD识别加密算法"></a>使用PEiD识别加密算法</h3><p>使用PEID的Kyrpto ANALyzer插件扫描病毒程序，来识别加密算法。扫描结果如图所示</p><img src="image-20201207144939176.png" alt="image-20201207144939176" style="zoom:50%;" /><p>由上图可知，该病毒使用RC4加密算法。</p><h3 id="查看导入表"><a href="#查看导入表" class="headerlink" title="查看导入表"></a>查看导入表</h3><img src="image-20201207101230560.png" alt="image-20201207101230560" style="zoom:50%;" /><p>输入表存在ADVAPI32.dll中的注册表和windows服务API，说明有可能该病毒存在创建、操作注册表和windows服务的行为。存在urlmon.dll的URLOpenBlockingStreamA API，有可能从网上URL下载数据（有可能是上面字符串提取的URL）。存在WS2_32.dll Windows Sockets应用程序接口， 用于支持Internet和网络应用程序。</p><p>此处需要留意</p><h3 id="查看资源段"><a href="#查看资源段" class="headerlink" title="查看资源段"></a>查看资源段</h3><p>接着查看病毒的资源段</p><img src="image-20201207103845767.png" alt="image-20201207103845767" style="zoom:50%;" /><p>存在100号、101号、102号三个资源，从资源头看不出是什么文件， 猜测有可能经过加密。</p><h2 id="基础动态分析"><a href="#基础动态分析" class="headerlink" title="基础动态分析"></a>基础动态分析</h2><h3 id="查看进程树"><a href="#查看进程树" class="headerlink" title="查看进程树"></a>查看进程树</h3><p>首先使用<code>ProcessMonitor</code>查看一下进程树。</p><img src="image-20201208111619297.png" alt="image-20201208111619297" style="zoom:50%;" /><h3 id="注册表监控"><a href="#注册表监控" class="headerlink" title="注册表监控"></a>注册表监控</h3><p>使用regshot对运行病毒前后做一个快照进行比对，直接查看结果。</p><img src="image-20201208112814269.png" alt="image-20201208112814269" style="zoom:50%;" /><img src="image-20201208111129817.png" alt="image-20201208111129817" style="zoom:50%;" /><h3 id="文件监控"><a href="#文件监控" class="headerlink" title="文件监控"></a>文件监控</h3><p>接下来是文件的监控</p><img src="image-20201208110819074.png" alt="image-20201208110819074" style="zoom:50%;" /><h3 id="网络监控"><a href="#网络监控" class="headerlink" title="网络监控"></a>网络监控</h3><p>请求恶意DNS域名</p><img src="image-20201209103816961.png" alt="image-20201209103816961" style="zoom:50%;" /><p>上传主机信息，并获取加密数据。</p><img src="image-20201209103458940.png" alt="image-20201209103458940" style="zoom:50%;" /> <h3 id="服务监控"><a href="#服务监控" class="headerlink" title="服务监控"></a>服务监控</h3><p>创建了两个服务：Ddriver和WebServers。</p><img src="image-20201208113024835.png" alt="image-20201208113024835" style="zoom:50%;" /><h1 id="使用IDA进行详细分析"><a href="#使用IDA进行详细分析" class="headerlink" title="使用IDA进行详细分析"></a>使用IDA进行详细分析</h1><p>主程序启动后首先尝试启动名为Ddriver的服务进程，如果主机已经被感染则直接执行服务函数进行挖矿等恶意行为，如果主机是初次被感染则执行感染配置行为。</p><img src="image-20201207105301424.png" alt="image-20201207105301424" style="zoom:50%;" /><p>第一步检查自身名称是否为svhost.exe或者svchost.exe，如果程序名称不为svhost.exe或者svchost.exe则从资源节中解密释放PE文件（102号资源），释放文件的hash：a4b7940b3d6b03269194f728610784d6，最终在磁盘中释放路径为C:\windows\temp\ttt.exe，释放完成后便执行该文件。</p><img src="image-20201207110637362.png" alt="image-20201207110637362" style="zoom:50%;" /><p>释放执行ttt.exe文件后便多次使用cmd命令清理系统原来感染的老版本的挖矿程序，为新版挖矿程序的安装和运行清理环境。结束删除老版的挖矿程序见下图。</p><img src="image-20201207111435563.png" alt="image-20201207111435563" style="zoom:50%;" /><p>设置Windows防火墙开启65531，65532，65533端口，在防火墙规则中分别命名为UDP2，UDP，ShareService，同时开启端口转发，将来自65532端口的流量转发到1.1.1.1地址的53端口，将来自65531端口的流量转发到1.1.1.1地址的53端口。设置防火墙并设置端口代理见下图。</p><p><img src="/2022/04/11/%E9%A9%B1%E5%8A%A8%E4%BA%BA%E7%94%9F%E6%9C%A8%E9%A9%AC%E5%88%86%E6%9E%90/image-20201207111615677.png" alt="image-20201207111615677"></p><p>拷贝主程序到C:\windows\system32\svhost.exe并设置隐藏属性，同时拷贝一份到C:\windows\system32\drivers\svchost.exe，之后设置计划任务同时设置注册表项，实现程序的开机启动和定期触发执行。拷贝主程序文件到系统关键目录下、设置计划任务和注册表项见下图。</p><img src="image-20201207112722576.png" alt="image-20201207112722576" style="zoom:50%;" /><img src="image-20201207112801022.png" alt="image-20201207112801022" style="zoom:50%;" /><p>完成上述配置后尝试使用CreateServiceA函数将C:\windows\system32\drivers\svchost.exe注册为服务，如果服务存在则修改服务配置，如果CreateServiceA函数调用失败则使用CMD方式调用sc create创建服务，最终尝试使用net start和StartServiceA函数的方式启动服务函数。创建Ddriver服务的首选方式，启动创建的Ddriver服务见下图。</p><img src="image-20201207113558713.png" alt="image-20201207113558713" style="zoom:50%;" /><img src="image-20201207113711717.png" alt="image-20201207113711717" style="zoom:50%;" /><p>服务主函数中首先根据系统位数拼接后续将要使用到的字符串资源，包括从恶意域名临时下载的文件以及解密之后的文件，和后续用来伪装成任务管理器共享进程进行挖矿操作taskmgr.exe。拼接后续需要使用的字符串见下图。</p><img src="image-20201207130526153.png" alt="image-20201207130526153" style="zoom:50%;" /><p>创建名为“it is holy shit”的互斥体防止进程重复启动运行，根据系统位数解密释放对应的资源文件，64位系统解密释放100号资源，32位系统解密释放标号为101号资源，释放路径为C:\Windows\system32\drivers\taskmgr.exe(64位系统：C:\Windows\SysWOW64\drivers\taskmgr.exe)。利用互斥体防止进程重复启动，根据系统位数释放taskmgr.exe文件见下图。</p><img src="image-20201207132730798.png" alt="image-20201207132730798" style="zoom:50%;" /><img src="image-20201207132921307.png" alt="image-20201207132921307" style="zoom:50%;" /><p>之后创建四个线程分别进行相关的恶意操作，第一个线程根据主机中的进程和主机系统相关参数调整挖矿程序的运行状态，当用户打开任务管理器浏览时会自动关闭伪装程序taskmgr.exe，使其不被用户发现；第二个线程每隔10s尝试启动C:\Windows\temp\svchost.exe(永恒之蓝漏洞攻击文件)，实现内网的横向感染传播；第三个线程使用Wmic命令，每10秒对进程进行一次检查，触发时将结束挖矿进程；第四个线程打开监听65533端口。</p><img src="image-20201207133414011.png" alt="image-20201207133414011" style="zoom:50%;" /><p>收集主机信息并发送到远程服务器，收集的信息包括主机ID，GUID，MAC地址，用户名，系统版本，系统位数，CPU型号，安装的反病毒软件(能够识别的杀软包括:360tray.exe|360sd.exe|avp.exe|KvMonXP.exe|RavMonD.exe|Mcshield.exe|egui.exe|kxetray.exe|knsdtray.exe|TMBMSRV.exe|avcenter.exe|ashDisp.exe|rtvscan.exe|ksafe.exe|QQPCRTP.exe)等等，最终在下载下一步指令的同时将上述信息传输到远程服务器。收集发送到远程服务器的主机信息见下图。</p><img src="image-20201207133857486.png" alt="image-20201207133857486" style="zoom:50%;" /><p>之后尝试访问远程服务器中指定的文件内容，从而获取执行指令，在本地解密后解析执行指令，发送的指令通过RC4+RSA算法进行加密，本地获取指令后通过硬编码的RSA公钥进行解密，最终解析执行远程命令。</p><p>由接受到的*.png中的指令内容下载指定的文件执行，当前指令的意图是从恶意域名http[:]&#x2F;&#x2F;dl.haqo.net&#x2F;下载i.exez资源，该资源为加密状态，下载到本地后解密执行，最终下载解密到C:\windows\temp\svchost.exe，目前下载的程序为永恒之蓝漏洞利用程序，该程序利用445端口实现了病毒的内网横向传播操作，该利用工具中还增加了PASS-THE-HASH的模块，尝试利用内网弱口令进行远程拷贝执行感染操作。下载指定文件解密执行见下图。</p><img src="image-20201207140500099.png" alt="image-20201207140500099" style="zoom:50%;" /><p>释放的ttt.exe文件执行之后会将自身移动到C:\Windows\System32\wmiex.exe(64位系统：C:\Windows\SysWOW64\wmiex.exe)并设置了隐藏属性，将自身写入计划任务，任务名为WebServers，每隔50分钟执行一次C:\Windows\system32\wmiex.exe(64位系统：C:\Windows\SysWOW64\wmiex.exe)，并创建服务WebServers设置为开机自启动。释放的ttt.exe文件被移动到指定路径、释放的ttt.exe（wmiex.exe）文件实现的命令见下图。</p><img src="clip_image002.jpg" alt="img" style="zoom:50%;" /><img src="clip_image004.jpg" alt="img" style="zoom:50%;" /><p>WebServers服务启动后会向指定的三个域名发起Get请求将获取的主机相关信息发送到远程服务器（pp.abbny.com、oo.beahh.com和ii.haqo.net），从而收集主机的相关信息，其中包含主机名，标识主机的GUID，主机MAC地址，主机系统和操作系统位数。上传信息所到的恶意域名见下图。</p><img src="clip_image005.png" alt="img"  /><p>WebServers服务同时具备Ddriver服务的联网功能，通过尝试下载指定域名的u.png文件，图片文件中包含了加密的指令内容，攻击者可以通过编辑该文件从而控制感染主机进行任意操作，也可以修改指令改变所下发的指令内容，当前该文件并不存在，因此WebServers不会执行其他恶意行为，仅仅处于等待指令的状态，在每次开机以及开机状态后每隔50分钟检查接收一次远程指令，wmiex.exe中的代码和svchost主程序中网络相关的代码基本一致，RSA公钥也是一样的，因此在这里算是攻击者的一个重复性操作。wmiex.exe和svchost.exe硬编码的公钥信息见下图。</p><img src="clip_image007.jpg" alt="img" style="zoom:50%;" /><h2 id="对病毒总体行为的总结"><a href="#对病毒总体行为的总结" class="headerlink" title="对病毒总体行为的总结"></a>对病毒总体行为的总结</h2><p>经对比分析，该病毒为“驱动人生”木马，通过驱动人生的升级通道下发。该病毒执行后便会将自身移动到系统关键目录并释放多个文件执行，上传主机的相关信息并从指定的恶意域名查询指令，根据黑客指令执行恶意行为。感染范围是安装了受影响的驱动人生程序的Windows系统，和内网中未打MS17-010系统补丁且开启445端口的Windows系统。</p><table><thead><tr><th><strong>文件行为：</strong></th></tr></thead><tbody><tr><td>下载保存文件到c:\windows\temp\updater.exe，执行后移动到其他位置</td></tr><tr><td>移动文件到c:\windows\system32\svhost.exe，并设置隐藏属性</td></tr><tr><td>拷贝文件到c:\windows\system32\drivers\svchost.exe，并设置隐藏属性</td></tr><tr><td>释放文件到c:\windows\system32\drivers\taskmgr.exe，并设置隐藏属性</td></tr><tr><td>释放文件到c:\windows\system32\wmiex.exe，并设置隐藏属性</td></tr><tr><td>下载文件到c:\windows\temp\svchost，此文件为永恒之蓝漏洞利用工具</td></tr><tr><td>释放文件到c:\windows\temp\m.ps1，此文件为mimikatz密码hash提取工具</td></tr><tr><td>释放文件到c:\windows\temp\mkatz.ini，此文件包含提取本机用户的hash值</td></tr><tr><td>注：在Windows64位系统中c:\windows\system32替换为c\windows\SysWOW64</td></tr></tbody></table><table><thead><tr><th><strong>注册表行为：</strong></th></tr></thead><tbody><tr><td>创建HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Ddriver</td></tr><tr><td>创建HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\WebServers</td></tr></tbody></table><table><thead><tr><th><strong>网络行为：</strong></th></tr></thead><tbody><tr><td>尝试上传主机信息到http[:]&#x2F;&#x2F;i.haqo.net</td></tr><tr><td>尝试上传主机信息到http[:]&#x2F;&#x2F;p.abbny.com</td></tr><tr><td>尝试上传主机信息到http[:]&#x2F;&#x2F;o.beahh.com</td></tr><tr><td>尝试上传主机信息到http[:]&#x2F;&#x2F;ii.haqo.net</td></tr><tr><td>尝试上传主机信息到http[:]&#x2F;&#x2F;pp.abbny.com</td></tr><tr><td>尝试上传主机信息到http[:]&#x2F;&#x2F;oo.beahh.com</td></tr><tr><td>尝试获取远控指令信息http[:]&#x2F;&#x2F;i.haqo.net&#x2F;i.png</td></tr><tr><td>尝试获取远控指令信息http[:]&#x2F;&#x2F;p.abbny.com&#x2F;im.png</td></tr><tr><td>尝试获取远控指令信息http[:]&#x2F;&#x2F;o.beahh.com&#x2F;i.png</td></tr><tr><td>尝试获取远控指令信息http[:]&#x2F;&#x2F;ii.haqo.net&#x2F;u.png</td></tr><tr><td>尝试获取远控指令信息http[:]&#x2F;&#x2F;pp.abbny.com&#x2F;u.png</td></tr><tr><td>尝试获取远控指令信息http[:]&#x2F;&#x2F;oo.beahh.com&#x2F;u.png</td></tr></tbody></table><h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><table><thead><tr><th><strong>删除计划任务，结束病毒进程并删除服务：</strong></th></tr></thead><tbody><tr><td>删除名为Ddrivers、WebServers、DnsScan、\Microsoft\Windows\Bluetooths的计划任务</td></tr><tr><td>删除可能存在的计划任务Certificate和Credentials</td></tr><tr><td>结束名为wmiex.exe进程以及描述为“svchost”的svchost进程</td></tr><tr><td>删除名为Ddriver和WebServers的服务项</td></tr></tbody></table><table><thead><tr><th><strong>删除下载和释放的病毒文件：</strong></th></tr></thead><tbody><tr><td>c:\Users[Username]\AppData\Roaming\Microsoft\Windows\Start  Menu\Programs\Startup\run.bat</td></tr><tr><td>c:\Users[Username]\AppData\Roaming\Microsoft\cred.ps1</td></tr><tr><td>c:\programdata\microsoft\cred.ps1</td></tr><tr><td>c:\windows\temp\updater.exe（upinstalled.exe）</td></tr><tr><td>c:\windows\system32\svhost.exe</td></tr><tr><td>c:\windows\system32\drivers\svchost.exe</td></tr><tr><td>c:\windows\system32\drivers\taskmgr.exe</td></tr><tr><td>c:\windows\system32\wmiex.exe</td></tr><tr><td>c:\windows\temp\svchost</td></tr><tr><td>c:\windows\temp\m.ps1</td></tr><tr><td>c:\windows\temp\mkatz.ini</td></tr><tr><td>注：[Username]替换为当前登录的用户名</td></tr></tbody></table><table><thead><tr><th><strong>删除病毒创建的注册表项：</strong></th></tr></thead><tbody><tr><td>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Ddriver</td></tr><tr><td>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\WebServers</td></tr></tbody></table><table><thead><tr><th><strong>删除病毒设置的防火墙栏目：</strong></th></tr></thead><tbody><tr><td>删除入站规则名为UDP，开放65532端口的规则</td></tr><tr><td>删除入站规则名为UDP2，开放65531端口的规则</td></tr><tr><td>删除入站规则名为ShareService，开放65533端口的规则</td></tr></tbody></table><table><thead><tr><th><strong>删除病毒设置的端口转发的设置：</strong></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>netsh interface  portproxy delete v4tov4 listenport&#x3D;65531</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>netsh interface  portproxy delete v4tov4 listenport&#x3D;65532</td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><p>  注：通过CMD管理员执行以上命令  </p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://www.freebuf.com/articles/network/196594.html">https://www.freebuf.com/articles/network/196594.html</a></p><p><a href="https://app.any.run/tasks/14168f29-4921-4dc4-a28b-113e3ed9fbe7/">https://app.any.run/tasks/14168f29-4921-4dc4-a28b-113e3ed9fbe7/</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>驱动人生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>望周知</title>
    <link href="/2022/04/11/%E6%9C%9B%E5%91%A8%E7%9F%A5/"/>
    <url>/2022/04/11/%E6%9C%9B%E5%91%A8%E7%9F%A5/</url>
    
    <content type="html"><![CDATA[<p>《中华人民共和国网络安全法》已由中华人民共和国第十二届全国人民代表大会常务委员会第二十四次会议于2016年11月7日通过，现予公布，自2017年6月1日起施行。</p><h2 id="法律全文"><a href="#法律全文" class="headerlink" title="法律全文"></a>法律全文</h2><h3 id="第一章-总则"><a href="#第一章-总则" class="headerlink" title="第一章 总则"></a>第一章 总则</h3><p>第一条　为了保障网络安全，维护网络空间主权和国家安全、社会公共利益，保护公民、法人和其他组织的合法权益，促进经济社会信息化健康发展，制定本法。</p><p>第二条　在中华人民共和国境内建设、运营、维护和使用网络，以及网络安全的监督管理，适用本法。</p><p>第三条　国家坚持网络安全与信息化发展并重，遵循积极利用、科学发展、依法管理、确保安全的方针，推进网络基础设施建设和互联互通，鼓励网络技术创新和应用，支持培养网络安全人才，建立健全网络安全保障体系，提高网络安全保护能力。</p><p>第四条　国家制定并不断完善网络安全战略，明确保障网络安全的基本要求和主要目标，提出重点领域的网络安全政策、工作任务和措施。</p><p>第五条　国家采取措施，监测、防御、处置来源于中华人民共和国境内外的网络安全风险和威胁，保护关键信息基础设施免受攻击、侵入、干扰和破坏，依法惩治网络违法犯罪活动，维护网络空间安全和秩序。</p><p>第六条　国家倡导诚实守信、健康文明的网络行为，推动传播社会主义核心价值观，采取措施提高全社会的网络安全意识和水平，形成全社会共同参与促进网络安全的良好环境。</p><p>第七条　国家积极开展网络空间治理、网络技术研发和标准制定、打击网络违法犯罪等方面的国际交流与合作，推动构建和平、安全、开放、合作的网络空间，建立多边、民主、透明的网络治理体系。</p><p>第八条　国家网信部门负责统筹协调网络安全工作和相关监督管理工作。国务院电信主管部门、公安部门和其他有关机关依照本法和有关法律、行政法规的规定，在各自职责范围内负责网络安全保护和监督管理工作。</p><p>县级以上地方人民政府有关部门的网络安全保护和监督管理职责，按照国家有关规定确定。</p><p>第九条　网络运营者开展经营和服务活动，必须遵守法律、行政法规，尊重社会公德，遵守商业道德，诚实信用，履行网络安全保护义务，接受政府和社会的监督，承担社会责任。</p><p>第十条　建设、运营网络或者通过网络提供服务，应当依照法律、行政法规的规定和国家标准的强制性要求，采取技术措施和其他必要措施，保障网络安全、稳定运行，有效应对网络安全事件，防范网络违法犯罪活动，维护网络数据的完整性、保密性和可用性。</p><p>第十一条　网络相关行业组织按照章程，加强行业自律，制定网络安全行为规范，指导会员加强网络安全保护，提高网络安全保护水平，促进行业健康发展。</p><p>第十二条　国家保护公民、法人和其他组织依法使用网络的权利，促进网络接入普及，提升网络服务水平，为社会提供安全、便利的网络服务，保障网络信息依法有序自由流动。</p><p>任何个人和组织使用网络应当遵守宪法法律，遵守公共秩序，尊重社会公德，不得危害网络安全，不得利用网络从事危害国家安全、荣誉和利益，煽动颠覆国家政权、推翻社会主义制度，煽动分裂国家、破坏国家统一，宣扬恐怖主义、极端主义，宣扬民族仇恨、民族歧视，传播暴力、淫秽色情信息，编造、传播虚假信息扰乱经济秩序和社会秩序，以及侵害他人名誉、隐私、知识产权和其他合法权益等活动。</p><p>第十三条　国家支持研究开发有利于未成年人健康成长的网络产品和服务，依法惩治利用网络从事危害未成年人身心健康的活动，为未成年人提供安全、健康的网络环境。</p><p>第十四条　任何个人和组织有权对危害网络安全的行为向网信、电信、公安等部门举报。收到举报的部门应当及时依法作出处理；不属于本部门职责的，应当及时移送有权处理的部门。</p><p>有关部门应当对举报人的相关信息予以保密，保护举报人的合法权益。</p><h3 id="第二章-网络安全支持与促进"><a href="#第二章-网络安全支持与促进" class="headerlink" title="第二章 网络安全支持与促进"></a>第二章 网络安全支持与促进</h3><p>第十五条　国家建立和完善网络安全标准体系。国务院标准化行政主管部门和国务院其他有关部门根据各自的职责，组织制定并适时修订有关网络安全管理以及网络产品、服务和运行安全的国家标准、行业标准。</p><p>国家支持企业、研究机构、高等学校、网络相关行业组织参与网络安全国家标准、行业标准的制定。</p><p>第十六条　国务院和省、自治区、直辖市人民政府应当统筹规划，加大投入，扶持重点网络安全技术产业和项目，支持网络安全技术的研究开发和应用，推广安全可信的网络产品和服务，保护网络技术知识产权，支持企业、研究机构和高等学校等参与国家网络安全技术创新项目。</p><p>第十七条　国家推进网络安全社会化服务体系建设，鼓励有关企业、机构开展网络安全认证、检测和风险评估等安全服务。</p><p>第十八条　国家鼓励开发网络数据安全保护和利用技术，促进公共数据资源开放，推动技术创新和经济社会发展。</p><p>国家支持创新网络安全管理方式，运用网络新技术，提升网络安全保护水平。</p><p>第十九条　各级人民政府及其有关部门应当组织开展经常性的网络安全宣传教育，并指导、督促有关单位做好网络安全宣传教育工作。</p><p>大众传播媒介应当有针对性地面向社会进行网络安全宣传教育。</p><p>第二十条　国家支持企业和高等学校、职业学校等教育培训机构开展网络安全相关教育与培训，采取多种方式培养网络安全人才，促进网络安全人才交流。</p><h3 id="第三章-网络运行安全"><a href="#第三章-网络运行安全" class="headerlink" title="第三章 网络运行安全"></a>第三章 网络运行安全</h3><p>第一节　一般规定</p><p>第二十一条　国家实行网络安全等级保护制度。网络运营者应当按照网络安全等级保护制度的要求，履行下列安全保护义务，保障网络免受干扰、破坏或者未经授权的访问，防止网络数据泄露或者被窃取、篡改：</p><p>（一）制定内部安全管理制度和操作规程，确定网络安全负责人，落实网络安全保护责任；</p><p>（二）采取防范计算机病毒和网络攻击、网络侵入等危害网络安全行为的技术措施；</p><p>（三）采取监测、记录网络运行状态、网络安全事件的技术措施，并按照规定留存相关的网络日志不少于六个月；</p><p>（四）采取数据分类、重要数据备份和加密等措施；</p><p>（五）法律、行政法规规定的其他义务。</p><p>第二十二条　网络产品、服务应当符合相关国家标准的强制性要求。网络产品、服务的提供者不得设置恶意程序；发现其网络产品、服务存在安全缺陷、漏洞等风险时，应当立即采取补救措施，按照规定及时告知用户并向有关主管部门报告。</p><p>网络产品、服务的提供者应当为其产品、服务持续提供安全维护；在规定或者当事人约定的期限内，不得终止提供安全维护。</p><p>网络产品、服务具有收集用户信息功能的，其提供者应当向用户明示并取得同意；涉及用户个人信息的，还应当遵守本法和有关法律、行政法规关于个人信息保护的规定。</p><p>第二十三条　网络关键设备和网络安全专用产品应当按照相关国家标准的强制性要求，由具备资格的机构安全认证合格或者安全检测符合要求后，方可销售或者提供。国家网信部门会同国务院有关部门制定、公布网络关键设备和网络安全专用产品目录，并推动安全认证和安全检测结果互认，避免重复认证、检测。</p><p>第二十四条　网络运营者为用户办理网络接入、域名注册服务，办理固定电话、移动电话等入网手续，或者为用户提供信息发布、即时通讯等服务，在与用户签订协议或者确认提供服务时，应当要求用户提供真实身份信息。用户不提供真实身份信息的，网络运营者不得为其提供相关服务。</p><p>国家实施网络可信身份战略，支持研究开发安全、方便的电子身份认证技术，推动不同电子身份认证之间的互认。</p><p>第二十五条　网络运营者应当制定网络安全事件应急预案，及时处置系统漏洞、计算机病毒、网络攻击、网络侵入等安全风险；在发生危害网络安全的事件时，立即启动应急预案，采取相应的补救措施，并按照规定向有关主管部门报告。</p><p>第二十六条　开展网络安全认证、检测、风险评估等活动，向社会发布系统漏洞、计算机病毒、网络攻击、网络侵入等网络安全信息，应当遵守国家有关规定。</p><p>第二十七条　任何个人和组织不得从事非法侵入他人网络、干扰他人网络正常功能、窃取网络数据等危害网络安全的活动；不得提供专门用于从事侵入网络、干扰网络正常功能及防护措施、窃取网络数据等危害网络安全活动的程序、工具；明知他人从事危害网络安全的活动的，不得为其提供技术支持、广告推广、支付结算等帮助。</p><p>第二十八条　网络运营者应当为公安机关、国家安全机关依法维护国家安全和侦查犯罪的活动提供技术支持和协助。</p><p>第二十九条　国家支持网络运营者之间在网络安全信息收集、分析、通报和应急处置等方面进行合作，提高网络运营者的安全保障能力。</p><p>有关行业组织建立健全本行业的网络安全保护规范和协作机制，加强对网络安全风险的分析评估，定期向会员进行风险警示，支持、协助会员应对网络安全风险。</p><p>第三十条　网信部门和有关部门在履行网络安全保护职责中获取的信息，只能用于维护网络安全的需要，不得用于其他用途。</p><p>第二节　关键信息基础设施的运行安全</p><p>第三十一条　国家对公共通信和信息服务、能源、交通、水利、金融、公共服务、电子政务等重要行业和领域，以及其他一旦遭到破坏、丧失功能或者数据泄露，可能严重危害国家安全、国计民生、公共利益的关键信息基础设施，在网络安全等级保护制度的基础上，实行重点保护。关键信息基础设施的具体范围和安全保护办法由国务院制定。</p><p>国家鼓励关键信息基础设施以外的网络运营者自愿参与关键信息基础设施保护体系。</p><p>第三十二条　按照国务院规定的职责分工，负责关键信息基础设施安全保护工作的部门分别编制并组织实施本行业、本领域的关键信息基础设施安全规划，指导和监督关键信息基础设施运行安全保护工作。</p><p>第三十三条　建设关键信息基础设施应当确保其具有支持业务稳定、持续运行的性能，并保证安全技术措施同步规划、同步建设、同步使用。</p><p>第三十四条　除本法第二十一条的规定外，关键信息基础设施的运营者还应当履行下列安全保护义务：</p><p>（一）设置专门安全管理机构和安全管理负责人，并对该负责人和关键岗位的人员进行安全背景审查；</p><p>（二）定期对从业人员进行网络安全教育、技术培训和技能考核；</p><p>（三）对重要系统和数据库进行容灾备份；</p><p>（四）制定网络安全事件应急预案，并定期进行演练；</p><p>（五）法律、行政法规规定的其他义务。</p><p>第三十五条　关键信息基础设施的运营者采购网络产品和服务，可能影响国家安全的，应当通过国家网信部门会同国务院有关部门组织的国家安全审查。</p><p>第三十六条　关键信息基础设施的运营者采购网络产品和服务，应当按照规定与提供者签订安全保密协议，明确安全和保密义务与责任。</p><p>第三十七条　关键信息基础设施的运营者在中华人民共和国境内运营中收集和产生的个人信息和重要数据应当在境内存储。因业务需要，确需向境外提供的，应当按照国家网信部门会同国务院有关部门制定的办法进行安全评估；法律、行政法规另有规定的，依照其规定。</p><p>第三十八条　关键信息基础设施的运营者应当自行或者委托网络安全服务机构对其网络的安全性和可能存在的风险每年至少进行一次检测评估，并将检测评估情况和改进措施报送相关负责关键信息基础设施安全保护工作的部门。</p><p>第三十九条　国家网信部门应当统筹协调有关部门对关键信息基础设施的安全保护采取下列措施：</p><p>（一）对关键信息基础设施的安全风险进行抽查检测，提出改进措施，必要时可以委托网络安全服务机构对网络存在的安全风险进行检测评估；</p><p>（二）定期组织关键信息基础设施的运营者进行网络安全应急演练，提高应对网络安全事件的水平和协同配合能力；</p><p>（三）促进有关部门、关键信息基础设施的运营者以及有关研究机构、网络安全服务机构等之间的网络安全信息共享；</p><p>（四）对网络安全事件的应急处置与网络功能的恢复等，提供技术支持和协助。</p><h3 id="第四章-网络信息安全"><a href="#第四章-网络信息安全" class="headerlink" title="第四章 网络信息安全"></a>第四章 网络信息安全</h3><p>第四十条　网络运营者应当对其收集的用户信息严格保密，并建立健全用户信息保护制度。</p><p>第四十一条　网络运营者收集、使用个人信息，应当遵循合法、正当、必要的原则，公开收集、使用规则，明示收集、使用信息的目的、方式和范围，并经被收集者同意。</p><p>网络运营者不得收集与其提供的服务无关的个人信息，不得违反法律、行政法规的规定和双方的约定收集、使用个人信息，并应当依照法律、行政法规的规定和与用户的约定，处理其保存的个人信息。</p><p>第四十二条　网络运营者不得泄露、篡改、毁损其收集的个人信息；未经被收集者同意，不得向他人提供个人信息。但是，经过处理无法识别特定个人且不能复原的除外。</p><p>网络运营者应当采取技术措施和其他必要措施，确保其收集的个人信息安全，防止信息泄露、毁损、丢失。在发生或者可能发生个人信息泄露、毁损、丢失的情况时，应当立即采取补救措施，按照规定及时告知用户并向有关主管部门报告。</p><p>第四十三条　个人发现网络运营者违反法律、行政法规的规定或者双方的约定收集、使用其个人信息的，有权要求网络运营者删除其个人信息；发现网络运营者收集、存储的其个人信息有错误的，有权要求网络运营者予以更正。网络运营者应当采取措施予以删除或者更正。</p><p>第四十四条　任何个人和组织不得窃取或者以其他非法方式获取个人信息，不得非法出售或者非法向他人提供个人信息。</p><p>第四十五条　依法负有网络安全监督管理职责的部门及其工作人员，必须对在履行职责中知悉的个人信息、隐私和商业秘密严格保密，不得泄露、出售或者非法向他人提供。</p><p>第四十六条　任何个人和组织应当对其使用网络的行为负责，不得设立用于实施诈骗，传授犯罪方法，制作或者销售违禁物品、管制物品等违法犯罪活动的网站、通讯群组，不得利用网络发布涉及实施诈骗，制作或者销售违禁物品、管制物品以及其他违法犯罪活动的信息。</p><p>第四十七条　网络运营者应当加强对其用户发布的信息的管理，发现法律、行政法规禁止发布或者传输的信息的，应当立即停止传输该信息，采取消除等处置措施，防止信息扩散，保存有关记录，并向有关主管部门报告。</p><p>第四十八条　任何个人和组织发送的电子信息、提供的应用软件，不得设置恶意程序，不得含有法律、行政法规禁止发布或者传输的信息。</p><p>电子信息发送服务提供者和应用软件下载服务提供者，应当履行安全管理义务，知道其用户有前款规定行为的，应当停止提供服务，采取消除等处置措施，保存有关记录，并向有关主管部门报告。</p><p>第四十九条　网络运营者应当建立网络信息安全投诉、举报制度，公布投诉、举报方式等信息，及时受理并处理有关网络信息安全的投诉和举报。</p><p>网络运营者对网信部门和有关部门依法实施的监督检查，应当予以配合。</p><p>第五十条　国家网信部门和有关部门依法履行网络信息安全监督管理职责，发现法律、行政法规禁止发布或者传输的信息的，应当要求网络运营者停止传输，采取消除等处置措施，保存有关记录；对来源于中华人民共和国境外的上述信息，应当通知有关机构采取技术措施和其他必要措施阻断传播。</p><h3 id="第五章-监测预警与应急处置"><a href="#第五章-监测预警与应急处置" class="headerlink" title="第五章 监测预警与应急处置"></a>第五章 监测预警与应急处置</h3><p>第五十一条　国家建立网络安全监测预警和信息通报制度。国家网信部门应当统筹协调有关部门加强网络安全信息收集、分析和通报工作，按照规定统一发布网络安全监测预警信息。</p><p>第五十二条　负责关键信息基础设施安全保护工作的部门，应当建立健全本行业、本领域的网络安全监测预警和信息通报制度，并按照规定报送网络安全监测预警信息。</p><p>第五十三条　国家网信部门协调有关部门建立健全网络安全风险评估和应急工作机制，制定网络安全事件应急预案，并定期组织演练。</p><p>负责关键信息基础设施安全保护工作的部门应当制定本行业、本领域的网络安全事件应急预案，并定期组织演练。</p><p>网络安全事件应急预案应当按照事件发生后的危害程度、影响范围等因素对网络安全事件进行分级，并规定相应的应急处置措施。</p><p>第五十四条　网络安全事件发生的风险增大时，省级以上人民政府有关部门应当按照规定的权限和程序，并根据网络安全风险的特点和可能造成的危害，采取下列措施：</p><p>（一）要求有关部门、机构和人员及时收集、报告有关信息，加强对网络安全风险的监测；</p><p>（二）组织有关部门、机构和专业人员，对网络安全风险信息进行分析评估，预测事件发生的可能性、影响范围和危害程度；</p><p>（三）向社会发布网络安全风险预警，发布避免、减轻危害的措施。</p><p>第五十五条　发生网络安全事件，应当立即启动网络安全事件应急预案，对网络安全事件进行调查和评估，要求网络运营者采取技术措施和其他必要措施，消除安全隐患，防止危害扩大，并及时向社会发布与公众有关的警示信息。</p><p>第五十六条　省级以上人民政府有关部门在履行网络安全监督管理职责中，发现网络存在较大安全风险或者发生安全事件的，可以按照规定的权限和程序对该网络的运营者的法定代表人或者主要负责人进行约谈。网络运营者应当按照要求采取措施，进行整改，消除隐患。</p><p>第五十七条　因网络安全事件，发生突发事件或者生产安全事故的，应当依照《中华人民共和国突发事件应对法》、《中华人民共和国安全生产法》等有关法律、行政法规的规定处置。</p><p>第五十八条 因维护国家安全和社会公共秩序，处置重大突发社会安全事件的需要，经国务院决定或者批准，可以在特定区域对网络通信采取限制等临时措施。</p><h3 id="第六章-法律责任"><a href="#第六章-法律责任" class="headerlink" title="第六章 法律责任"></a>第六章 法律责任</h3><p>第五十九条　网络运营者不履行本法第二十一条、第二十五条规定的网络安全保护义务的，由有关主管部门责令改正，给予警告；拒不改正或者导致危害网络安全等后果的，处一万元以上十万元以下罚款，对直接负责的主管人员处五千元以上五万元以下罚款。</p><p>关键信息基础设施的运营者不履行本法第三十三条、第三十四条、第三十六条、第三十八条规定的网络安全保护义务的，由有关主管部门责令改正，给予警告；拒不改正或者导致危害网络安全等后果的，处十万元以上一百万元以下罚款，对直接负责的主管人员处一万元以上十万元以下罚款。</p><p>第六十条　违反本法第二十二条第一款、第二款和第四十八条第一款规定，有下列行为之一的，由有关主管部门责令改正，给予警告；拒不改正或者导致危害网络安全等后果的，处五万元以上五十万元以下罚款，对直接负责的主管人员处一万元以上十万元以下罚款：</p><p>（一）设置恶意程序的；</p><p>（二）对其产品、服务存在的安全缺陷、漏洞等风险未立即采取补救措施，或者未按照规定及时告知用户并向有关主管部门报告的；</p><p>（三）擅自终止为其产品、服务提供安全维护的。</p><p>第六十一条　网络运营者违反本法第二十四条第一款规定，未要求用户提供真实身份信息，或者对不提供真实身份信息的用户提供相关服务的，由有关主管部门责令改正；拒不改正或者情节严重的，处五万元以上五十万元以下罚款，并可以由有关主管部门责令暂停相关业务、停业整顿、关闭网站、吊销相关业务许可证或者吊销营业执照，对直接负责的主管人员和其他直接责任人员处一万元以上十万元以下罚款。</p><p>第六十二条　违反本法第二十六条规定，开展网络安全认证、检测、风险评估等活动，或者向社会发布系统漏洞、计算机病毒、网络攻击、网络侵入等网络安全信息的，由有关主管部门责令改正，给予警告；拒不改正或者情节严重的，处一万元以上十万元以下罚款，并可以由有关主管部门责令暂停相关业务、停业整顿、关闭网站、吊销相关业务许可证或者吊销营业执照，对直接负责的主管人员和其他直接责任人员处五千元以上五万元以下罚款。</p><p>第六十三条　违反本法第二十七条规定，从事危害网络安全的活动，或者提供专门用于从事危害网络安全活动的程序、工具，或者为他人从事危害网络安全的活动提供技术支持、广告推广、支付结算等帮助，尚不构成犯罪的，由公安机关没收违法所得，处五日以下拘留，可以并处五万元以上五十万元以下罚款；情节较重的，处五日以上十五日以下拘留，可以并处十万元以上一百万元以下罚款。</p><p>单位有前款行为的，由公安机关没收违法所得，处十万元以上一百万元以下罚款，并对直接负责的主管人员和其他直接责任人员依照前款规定处罚。</p><p>违反本法第二十七条规定，受到治安管理处罚的人员，五年内不得从事网络安全管理和网络运营关键岗位的工作；受到刑事处罚的人员，终身不得从事网络安全管理和网络运营关键岗位的工作。</p><p>第六十四条　网络运营者、网络产品或者服务的提供者违反本法第二十二条第三款、第四十一条至第四十三条规定，侵害个人信息依法得到保护的权利的，由有关主管部门责令改正，可以根据情节单处或者并处警告、没收违法所得、处违法所得一倍以上十倍以下罚款，没有违法所得的，处一百万元以下罚款，对直接负责的主管人员和其他直接责任人员处一万元以上十万元以下罚款；情节严重的，并可以责令暂停相关业务、停业整顿、关闭网站、吊销相关业务许可证或者吊销营业执照。</p><p>违反本法第四十四条规定，窃取或者以其他非法方式获取、非法出售或者非法向他人提供个人信息，尚不构成犯罪的，由公安机关没收违法所得，并处违法所得一倍以上十倍以下罚款，没有违法所得的，处一百万元以下罚款。</p><p>第六十五条　关键信息基础设施的运营者违反本法第三十五条规定，使用未经安全审查或者安全审查未通过的网络产品或者服务的，由有关主管部门责令停止使用，处采购金额一倍以上十倍以下罚款；对直接负责的主管人员和其他直接责任人员处一万元以上十万元以下罚款。</p><p>第六十六条　关键信息基础设施的运营者违反本法第三十七条规定，在境外存储网络数据，或者向境外提供网络数据的，由有关主管部门责令改正，给予警告，没收违法所得，处五万元以上五十万元以下罚款，并可以责令暂停相关业务、停业整顿、关闭网站、吊销相关业务许可证或者吊销营业执照；对直接负责的主管人员和其他直接责任人员处一万元以上十万元以下罚款。</p><p>第六十七条　违反本法第四十六条规定，设立用于实施违法犯罪活动的网站、通讯群组，或者利用网络发布涉及实施违法犯罪活动的信息，尚不构成犯罪的，由公安机关处五日以下拘留，可以并处一万元以上十万元以下罚款；情节较重的，处五日以上十五日以下拘留，可以并处五万元以上五十万元以下罚款。关闭用于实施违法犯罪活动的网站、通讯群组。</p><p>单位有前款行为的，由公安机关处十万元以上五十万元以下罚款，并对直接负责的主管人员和其他直接责任人员依照前款规定处罚。</p><p>第六十八条　网络运营者违反本法第四十七条规定，对法律、行政法规禁止发布或者传输的信息未停止传输、采取消除等处置措施、保存有关记录的，由有关主管部门责令改正，给予警告，没收违法所得；拒不改正或者情节严重的，处十万元以上五十万元以下罚款，并可以责令暂停相关业务、停业整顿、关闭网站、吊销相关业务许可证或者吊销营业执照，对直接负责的主管人员和其他直接责任人员处一万元以上十万元以下罚款。</p><p>电子信息发送服务提供者、应用软件下载服务提供者，不履行本法第四十八条第二款规定的安全管理义务的，依照前款规定处罚。</p><p>第六十九条　网络运营者违反本法规定，有下列行为之一的，由有关主管部门责令改正；拒不改正或者情节严重的，处五万元以上五十万元以下罚款，对直接负责的主管人员和其他直接责任人员，处一万元以上十万元以下罚款：</p><p>（一）不按照有关部门的要求对法律、行政法规禁止发布或者传输的信息，采取停止传输、消除等处置措施的；</p><p>（二）拒绝、阻碍有关部门依法实施的监督检查的；</p><p>（三）拒不向公安机关、国家安全机关提供技术支持和协助的。</p><p>第七十条　发布或者传输本法第十二条第二款和其他法律、行政法规禁止发布或者传输的信息的，依照有关法律、行政法规的规定处罚。</p><p>第七十一条　有本法规定的违法行为的，依照有关法律、行政法规的规定记入信用档案，并予以公示。</p><p>第七十二条　国家机关政务网络的运营者不履行本法规定的网络安全保护义务的，由其上级机关或者有关机关责令改正；对直接负责的主管人员和其他直接责任人员依法给予处分。</p><p>第七十三条　网信部门和有关部门违反本法第三十条规定，将在履行网络安全保护职责中获取的信息用于其他用途的，对直接负责的主管人员和其他直接责任人员依法给予处分。</p><p>网信部门和有关部门的工作人员玩忽职守、滥用职权、徇私舞弊，尚不构成犯罪的，依法给予处分。</p><p>第七十四条　违反本法规定，给他人造成损害的，依法承担民事责任。</p><p>违反本法规定，构成违反治安管理行为的，依法给予治安管理处罚；构成犯罪的，依法追究刑事责任。</p><p>第七十五条　境外的机构、组织、个人从事攻击、侵入、干扰、破坏等危害中华人民共和国的关键信息基础设施的活动，造成严重后果的，依法追究法律责任；国务院公安部门和有关部门并可以决定对该机构、组织、个人采取冻结财产或者其他必要的制裁措施。</p><h3 id="第七章-附则"><a href="#第七章-附则" class="headerlink" title="第七章 附则"></a>第七章 附则</h3><p>第七十六条　本法下列用语的含义：</p><p>（一）网络，是指由计算机或者其他信息终端及相关设备组成的按照一定的规则和程序对信息进行收集、存储、传输、交换、处理的系统。</p><p>（二）网络安全，是指通过采取必要措施，防范对网络的攻击、侵入、干扰、破坏和非法使用以及意外事故，使网络处于稳定可靠运行的状态，以及保障网络数据的完整性、保密性、可用性的能力。</p><p>（三）网络运营者，是指网络的所有者、管理者和网络服务提供者。</p><p>（四）网络数据，是指通过网络收集、存储、传输、处理和产生的各种电子数据。</p><p>（五）个人信息，是指以电子或者其他方式记录的能够单独或者与其他信息结合识别自然人个人身份的各种信息，包括但不限于自然人的姓名、出生日期、身份证件号码、个人生物识别信息、住址、电话号码等。</p><p>第七十七条　存储、处理涉及国家秘密信息的网络的运行安全保护，除应当遵守本法外，还应当遵守保密法律、行政法规的规定。</p><p>第七十八条　军事网络的安全保护，由中央军事委员会另行规定。</p><p>第七十九条　本法自2017年6月1日起施行。</p>]]></content>
    
    
    
    <tags>
      
      <tag>网络安全法</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
